
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>data_tools.diffusion &#8212; data_tools 0.0.6 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="data_tools.iterables" href="iterables.html" />
    <link rel="prev" title="data_tools.databases" href="databases.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="iterables.html" title="data_tools.iterables"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="databases.html" title="data_tools.databases"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">data_tools 0.0.6 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <span class="target" id="module-data_tools.diffusion"></span><div class="section" id="data-tools-diffusion">
<h1>data_tools.diffusion<a class="headerlink" href="#data-tools-diffusion" title="Permalink to this headline">¶</a></h1>
<p>Diffusion solvers module.</p>
<p>The following functions provide tools to compute the diffusion on one or
two dimensions with different explicit or implicit methods.</p>
<p><strong>NOTE:</strong> Explicit methods (<code class="docutils literal notranslate"><span class="pre">'euler_explicit1D'</span></code> and
<code class="docutils literal notranslate"><span class="pre">'euler_explicit2D'</span></code>) are conditionally stable. This means that in
order to keep numerical stability of the solution (and obtain an
accurate result), these methods need to fulfill the
Courant–Friedrichs–Lewy (CFL) condition. For the one-dimensional case:</p>
<div class="math notranslate nohighlight">
\[D\frac{\Delta t}{\Delta x^2}\leq\frac{1}{2}\]</div>
<p>For the two-dimensional case (and assuming <span class="math notranslate nohighlight">\(\Delta x=\Delta y\)</span>):</p>
<div class="math notranslate nohighlight">
\[D\frac{\Delta t}{\Delta x^2}\leq\frac{1}{4}\]</div>
<p>The implicit methods are (theoretically) unconditionally stable, hence
are more permissive in terms of discretization step-size.</p>
<p>Currently for the implicit methods only the coefficient matrix
contruction is available. To solve the diffusion problem user can use
any of the available linear algebra solvers by providing the current
diffusing field state and the matrix on each time-step.</p>
<ul class="simple">
<li>Simplest options are either <code class="docutils literal notranslate"><span class="pre">numpy.linalg.solve()</span></code> or
<code class="docutils literal notranslate"><span class="pre">scipy.linalg.solve()</span></code> (both not very fast).</li>
<li>If the coefficient matrix is positive-definite (it is most of the
times, but can be double-checked, specially if errors arise) and
symmetric, a good option is Choleski’s factorization. This is already
implemented in <code class="docutils literal notranslate"><span class="pre">scipy.linalg.cholesky()</span></code> which factorizes the
coefficient matrix and that can be passed to the
<code class="docutils literal notranslate"><span class="pre">scipy.linalg.cho_solve()</span></code> which is way faster than the option above.</li>
<li>Another option (but don’t tell anyone) is to invert the coefficient
matrix and just solve the equation with a matrix multiplication. This
is way faster but your coefficient matrix has to be invertible. If
the determinant is close to zero, may cause numerical instability.</li>
</ul>
<dl class="function">
<dt id="data_tools.diffusion.euler_explicit1D">
<code class="descclassname">data_tools.diffusion.</code><code class="descname">euler_explicit1D</code><span class="sig-paren">(</span><em>x0</em>, <em>dt</em>, <em>dx2</em>, <em>d=1</em>, <em>bcs='periodic'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data_tools/diffusion.html#euler_explicit1D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data_tools.diffusion.euler_explicit1D" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes diffusion on a 1D space over a time-step using Euler
explicit method.</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>Arguments:</dt>
<dd><ul class="first last">
<li><em>x0</em> [numpy.ndarray]: Initial state of a 1D array from which
the difusion is to be computed.</li>
<li><em>dt</em> [float]: Discretization time-step.</li>
<li><em>dx2</em> [float]: Discretization spatial-step (squared).</li>
<li><em>d</em> [float]: Optional, <code class="docutils literal notranslate"><span class="pre">1</span></code> by default. The diffusion
coefficient.</li>
<li><em>bcs</em> [str]: Optional, <code class="docutils literal notranslate"><span class="pre">'periodic'</span></code> by default. Determines
the boundary conditions. Available options are <code class="docutils literal notranslate"><span class="pre">'periodic'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'dirichlet''</span></code> or <code class="docutils literal notranslate"><span class="pre">'neumann'</span></code>. Note that Dirichlet BCs do
not hold mass conservation.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Returns:</dt>
<dd><ul class="first last">
<li>[numpy.ndarray]: Computed state array (1D) after one time-step
according to the parameters and conditions selected.</li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="data_tools.diffusion.euler_explicit2D">
<code class="descclassname">data_tools.diffusion.</code><code class="descname">euler_explicit2D</code><span class="sig-paren">(</span><em>x0</em>, <em>dt</em>, <em>dx2</em>, <em>d=1</em>, <em>bcs='periodic'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data_tools/diffusion.html#euler_explicit2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data_tools.diffusion.euler_explicit2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes diffusion on a 2D space over a time-step using Euler
explicit method.</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>Arguments:</dt>
<dd><ul class="first last">
<li><em>x0</em> [numpy.ndarray]: Initial state of a 2D array from which
the difusion is to be computed.</li>
<li><em>dt</em> [float]: Discretization time-step.</li>
<li><em>dx2</em> [float]: Discretization spatial-step (squared). It is
assumed that is the same in both dimensions (dx = dy).</li>
<li><em>d</em> [float]: Optional, <code class="docutils literal notranslate"><span class="pre">1</span></code> by default. The diffusion
coefficient.</li>
<li><em>bcs</em> [str]: Optional, <code class="docutils literal notranslate"><span class="pre">'periodic'</span></code> by default. Determines
the boundary conditions. Available options are <code class="docutils literal notranslate"><span class="pre">'periodic'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'dirichlet''</span></code> or <code class="docutils literal notranslate"><span class="pre">'neumann'</span></code>. Note that Dirichlet BCs do
not hold mass conservation.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Returns:</dt>
<dd><ul class="first last">
<li>[numpy.ndarray]: Computed state array (2D) after one time-step
according to the parameters and conditions selected.</li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="data_tools.diffusion.euler_implicit_coef_mat">
<code class="descclassname">data_tools.diffusion.</code><code class="descname">euler_implicit_coef_mat</code><span class="sig-paren">(</span><em>dx2</em>, <em>dt</em>, <em>nx</em>, <em>ny=None</em>, <em>d=1</em>, <em>bcs='periodic'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data_tools/diffusion.html#euler_implicit_coef_mat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data_tools.diffusion.euler_implicit_coef_mat" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the coefficient matrix to solve the diffusion problem with
the Euler implicit method such that:</p>
<div class="math notranslate nohighlight">
\[\mathbf{A}\cdot u^{n+1}=u^{n}\]</div>
<p>Where <strong>A</strong> is the coefficient matrix and <em>u</em> the diffusing field.
Note that for a 2D space, it is considered that <em>u</em> has been
vectorized beforehand (e.g.: <cite>u.reshape(-1)</cite> assuming <cite>u</cite> is a 2D
[<cite>numpy.ndarray</cite>]).</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>Arguments:</dt>
<dd><ul class="first last">
<li><em>dx2</em> [float]: Discretization spatial-step (squared). It is
assumed that is the same in both dimensions (dx = dy).</li>
<li><em>dt</em> [float]: Discretization time-step.</li>
<li><em>nx</em> [int]: The number of discrete steps in the first spatial
dimension.</li>
<li><em>ny</em> [int]: Optional, <code class="docutils literal notranslate"><span class="pre">None</span></code> by default. The number of
discrete steps in the second spatial dimension (if any).</li>
<li><em>d</em> [float]: Optional, <code class="docutils literal notranslate"><span class="pre">1</span></code> by default. The diffusion
coefficient.</li>
<li><em>bcs</em> [str]: Optional, <code class="docutils literal notranslate"><span class="pre">'periodic'</span></code> by default. Determines
the boundary conditions. Available options are <code class="docutils literal notranslate"><span class="pre">'periodic'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'dirichlet''</span></code> or <code class="docutils literal notranslate"><span class="pre">'neumann'</span></code>. Note that Dirichlet BCs do
not hold mass conservation.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Returns:</dt>
<dd><ul class="first last">
<li>[numpy.ndarray]: The coefficient matrix. Shape is <cite>[nx, nx]</cite>
for one-dimensional problem and <cite>[nx*ny, nx*ny]</cite> for the
two-dimensional case.</li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="data_tools.diffusion.crank_nicolson_coef_mats">
<code class="descclassname">data_tools.diffusion.</code><code class="descname">crank_nicolson_coef_mats</code><span class="sig-paren">(</span><em>dx2</em>, <em>dt</em>, <em>nx</em>, <em>ny=None</em>, <em>d=1</em>, <em>bcs='periodic'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data_tools/diffusion.html#crank_nicolson_coef_mats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data_tools.diffusion.crank_nicolson_coef_mats" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the coefficient matrices to solve the diffusion problem
with the Crank-Nicolson method such that:</p>
<div class="math notranslate nohighlight">
\[\mathbf{B}\cdot u^{n+1}=\mathbf{D}\cdot u^{n}\]</div>
<p>Where <strong>B</strong> and <strong>D</strong> are the coefficient matrices and <em>u</em> the
diffusing field. Note that for a 2D space, it is considered that <em>u</em>
has been vectorized beforehand (e.g.: <cite>u.reshape(-1)</cite> assuming <cite>u</cite>
is a 2D [<cite>numpy.ndarray</cite>]).</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>Arguments:</dt>
<dd><ul class="first last">
<li><em>dx2</em> [float]: Discretization spatial-step (squared). It is
assumed that is the same in both dimensions (dx = dy).</li>
<li><em>dt</em> [float]: Discretization time-step.</li>
<li><em>nx</em> [int]: The number of discrete steps in the first spatial
dimension.</li>
<li><em>ny</em> [int]: Optional, <code class="docutils literal notranslate"><span class="pre">None</span></code> by default. The number of
discrete steps in the second spatial dimension (if any).</li>
<li><em>d</em> [float]: Optional, <code class="docutils literal notranslate"><span class="pre">1</span></code> by default. The diffusion
coefficient.</li>
<li><em>bcs</em> [str]: Optional, <code class="docutils literal notranslate"><span class="pre">'periodic'</span></code> by default. Determines
the boundary conditions. Available options are <code class="docutils literal notranslate"><span class="pre">'periodic'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'dirichlet''</span></code> or <code class="docutils literal notranslate"><span class="pre">'neumann'</span></code>. Note that Dirichlet BCs do
not hold mass conservation.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Returns:</dt>
<dd><ul class="first last">
<li>[numpy.ndarray]: The coefficient matrix <strong>B</strong>. Shape is
<cite>[nx, nx]</cite> for one-dimensional problem and <cite>[nx*ny, nx*ny]</cite>
for the two-dimensional case.</li>
<li>[numpy.ndarray]: The coefficient matrix <strong>D</strong>. Shape is the
same as <strong>B</strong>.</li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="data_tools.diffusion.build_coef_mat">
<code class="descclassname">data_tools.diffusion.</code><code class="descname">build_coef_mat</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>nx</em>, <em>ny=None</em>, <em>bcs='periodic'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data_tools/diffusion.html#build_coef_mat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data_tools.diffusion.build_coef_mat" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a coefficient matrix according to the central and neighbor
coefficients, system size and boundary conditions.</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>Arguments:</dt>
<dd><ul class="first last">
<li><em>a</em> [float]: The central element coefficient.</li>
<li><em>b</em> [float]: The neighbor element coefficient.</li>
<li><em>nx</em> [int]: The number of discrete steps in the first spatial
dimension.</li>
<li><em>ny</em> [int]: Optional, <code class="docutils literal notranslate"><span class="pre">None</span></code> by default. The number of
discrete steps in the second spatial dimension (if any).</li>
<li><em>bcs</em> [str]: Optional, <code class="docutils literal notranslate"><span class="pre">'periodic'</span></code> by default. Determines
the boundary conditions. Available options are <code class="docutils literal notranslate"><span class="pre">'periodic'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'dirichlet''</span></code> or <code class="docutils literal notranslate"><span class="pre">'neumann'</span></code>. Note that Dirichlet BCs do
not hold mass conservation.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Returns:</dt>
<dd><ul class="first last">
<li>[numpy.ndarray]: The coefficient matrix. Shape is <cite>[nx, nx]</cite>
for one-dimensional problem and <cite>[nx*ny, nx*ny]</cite> for the
two-dimensional case.</li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="databases.html"
                        title="previous chapter">data_tools.databases</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="iterables.html"
                        title="next chapter">data_tools.iterables</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/diffusion.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="iterables.html" title="data_tools.iterables"
             >next</a> |</li>
        <li class="right" >
          <a href="databases.html" title="data_tools.databases"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">data_tools 0.0.6 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Nicolàs Palacio.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.5.
    </div>
  </body>
</html>